<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.practice.schedule.dao.ScheduleDao">

    <select id="getScheduleList" resultType="com.example.practice.schedule.dto.ScheduleDto">
        select	title
             ,date_format(start_time, '%Y-%m-%dT%H:%i') start_time
             ,date_format(end_time, '%Y-%m-%dT%H:%i') end_time

        from	schedule
        where	date_format(start_time, '%Y-%m-%d') >= date_format(#{start_time}, '%Y-%m-%d')
          and	 	date_format(start_time, '%Y-%m-%d') &lt;= date_format(#{end_time}, '%Y-%m-%d')
    </select>


    <insert id="insertSchedule" parameterType="com.example.practice.schedule.dto.ScheduleDto">
        insert into schedule(
                                    title
                                  ,start_time
                                  ,end_time
                                  ,create_date
        )
        values(
                #{title}
              ,date_format(#{start_time}, '%Y-%m-%d %H:%i:%s')
              ,date_format(#{end_time}, '%Y-%m-%d %H:%i:%s')
              ,now()
              )
    </insert>

    <delete id="deleteSchedule" parameterType="com.example.practice.schedule.dto.ScheduleDto">
        delete	from schedule
        where 	title = #{title}
          and start_time = date_format(#{start_time}, '%Y-%m-%d %H:%i')
          and end_time = date_format(#{end_time}, '%Y-%m-%d %H:%i')
    </delete>



</mapper>
